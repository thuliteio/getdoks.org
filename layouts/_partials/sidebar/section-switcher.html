{{/* Section Switcher Dropdown for Documentation */}}
{{ $currentSection := .Section }}
{{ $availableSections := site.Params.doks.sectionNav }}

{{ if gt (len $availableSections) 1 }}
<div class="section-switcher mb-4">
  <div class="dropdown">
    <button class="btn btn-outline-secondary dropdown-toggle w-100 text-start d-flex justify-content-between align-items-center"
            type="button"
            id="sectionSwitcher"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            aria-label="Switch documentation section">
      <span class="d-flex align-items-center">
        {{ $currentSectionIcon := "" }}
        {{ $currentSectionTitle := "" }}

        {{/* Determine current section info */}}
        {{ if eq $currentSection "getting-started" }}
          {{ $currentSectionIcon = "rocket" }}
          {{ $currentSectionTitle = "Getting Started" }}
        {{ else if eq $currentSection "authoring" }}
          {{ $currentSectionIcon = "pencil" }}
          {{ $currentSectionTitle = "Authoring" }}
        {{ else if eq $currentSection "customization" }}
          {{ $currentSectionIcon = "settings" }}
          {{ $currentSectionTitle = "Customization" }}
        {{ else if eq $currentSection "reference" }}
          {{ $currentSectionIcon = "book" }}
          {{ $currentSectionTitle = "Reference" }}
        {{ else }}
          {{ $currentSectionIcon = "folder" }}
          {{ $currentSectionTitle = ($currentSection | humanize) }}
        {{ end }}

        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-{{ $currentSectionIcon }} me-2 mb-1 mb-lg-0" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
          {{ if eq $currentSectionIcon "rocket" }}
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M4 13a8 8 0 0 1 7 7a6 6 0 0 0 3 -5a9 9 0 0 0 6 -8a3 3 0 0 0 -3 -3a9 9 0 0 0 -8 6a6 6 0 0 0 -5 3" />
            <path d="M7 14a6 6 0 0 0 -3 6a6 6 0 0 0 6 -3" />
            <path d="M15 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
          {{ else if eq $currentSectionIcon "pencil" }}
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
            <path d="M13.5 6.5l4 4" />
          {{ else if eq $currentSectionIcon "settings" }}
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
            <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
          {{ else if eq $currentSectionIcon "book" }}
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
            <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
            <path d="M3 6l0 13" />
            <path d="M12 6l0 13" />
            <path d="M21 6l0 13" />
          {{ else }}
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2"/>
          {{ end }}
        </svg>
        <span class="fw-medium">{{ $currentSectionTitle }}</span>
      </span>
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-selector mb-1 mb-lg-0" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M8 9l4 -4l4 4" />
        <path d="M16 15l-4 4l-4 -4" />
      </svg>
    </button>

    <ul class="dropdown-menu w-100" aria-labelledby="sectionSwitcher">
      {{ range $availableSections }}
        {{ $section := . }}
        {{ $sectionPage := site.GetPage (printf "/%s" $section) }}
        {{ $isActive := eq $section $currentSection }}

        {{/* Only show section if it exists or has content */}}
        {{ if or $sectionPage (eq $section $currentSection) }}

        {{ $sectionIcon := "" }}
        {{ $sectionTitle := "" }}
        {{ $sectionUrl := "" }}

        {{/* Configure section info */}}
        {{ if eq $section "getting-started" }}
          {{ $sectionIcon = "rocket" }}
          {{ $sectionTitle = "Getting Started" }}
          {{ $sectionUrl = "/getting-started/introduction/quick-start/" }}
        {{ else if eq $section "authoring" }}
          {{ $sectionIcon = "pencil" }}
          {{ $sectionTitle = "Authoring" }}
          {{ $sectionUrl = "/authoring/shortcodes/using-shortcodes/" }}
        {{ else if eq $section "customization" }}
          {{ $sectionIcon = "settings" }}
          {{ $sectionTitle = "Customization" }}
          {{ $sectionUrl = "/customization/customizing/fonts/" }}
        {{ else if eq $section "reference" }}
          {{ $sectionIcon = "book" }}
          {{ $sectionTitle = "Reference" }}
          {{ $sectionUrl = "/reference/help/troubleshooting/" }}
        {{ else }}
          {{ $sectionIcon = "folder" }}
          {{ $sectionTitle = ($section | humanize) }}
          {{ $sectionUrl = (printf "/%s/" $section) }}
        {{ end }}

        <li>
          <a class="dropdown-item d-flex align-items-center{{ if $isActive }} active{{ end }}"
             href="{{ $sectionUrl }}"
             {{ if $isActive }}aria-current="page"{{ end }}>
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-{{ $sectionIcon }} me-2" width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              {{ if eq $sectionIcon "rocket" }}
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M4 13a8 8 0 0 1 7 7a6 6 0 0 0 3 -5a9 9 0 0 0 6 -8a3 3 0 0 0 -3 -3a9 9 0 0 0 -8 6a6 6 0 0 0 -5 3" />
                <path d="M7 14a6 6 0 0 0 -3 6a6 6 0 0 0 6 -3" />
                <path d="M15 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
              {{ else if eq $sectionIcon "pencil" }}
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
                <path d="M13.5 6.5l4 4" />
              {{ else if eq $sectionIcon "settings" }}
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
              {{ else if eq $sectionIcon "book" }}
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
                <path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" />
                <path d="M3 6l0 13" />
                <path d="M12 6l0 13" />
                <path d="M21 6l0 13" />
              {{ else }}
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2"/>
              {{ end }}
            </svg>
            <span>{{ $sectionTitle }}</span>
            {{ if $isActive }}
              <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check ms-auto" width="16" height="16" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                <path d="M5 12l5 5l10 -10"/>
              </svg>
            {{ end }}
          </a>
        </li>
        {{ end }}
      {{ end }}
    </ul>
  </div>
</div>
{{ end }}
